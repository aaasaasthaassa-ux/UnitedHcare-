{% load static %}

{% block title %}{{ provider.get_full_name }} - Provider{% endblock %}

{% block content %}
<!-- 
  This is a full HTML file for demonstration.
  In your Django project, you will only need to copy the 
  <style> block into your base.html <head> (if not already there)
  and the contents of <div id="page-content">...</div> 
  to replace your original HTML block.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Use the title from your block -->
    <title>{{ provider.get_full_name|default:provider.username }} - Provider - UH Care</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script>
        // Configuration for Tailwind
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'uh-blue': {
                            '700': '#004a9e', // Darker Blue from logo
                            '600': '#0056b3',
                            '100': '#e6f0ff',
                        },
                        'uh-green': {
                            '600': '#4CAF50', // Green from logo
                            '100': '#eaf7ea',
                        },
                        'uh-red': {
                            '600': '#D32F2F', // Red from logo heartbeat
                            '500': '#E53E3E',
                            '100': '#fbe9e9',
                        }
                    }
                }
            }
        }
    </script>

    <!-- 
      Base styles (would be in your base.html)
    -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Header -->
    <header class="bg-white shadow-sm">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex-shrink-0">
                    <!-- 
                      ****************************************************
                      * IMPORTANT: Replace 'YOUR_LOGO_URL_HERE.jpg'
                      * with the public URL of your hosted logo.
                      ****************************************************
                    -->
                    <img class="h-10 w-auto" 
                         src="YOUR_LOGO_URL_HERE.jpg" 
                         alt="UH Care Logo"
                         onerror="this.src='https://placehold.co/150x40/004a9e/ffffff?text=UH+Care&font=inter'; this.onerror=null;">
                </div>
            </div>
        </nav>
    </header>

    <!-- This div wraps your actual page content -->
    <div id="page-content">

    <!-- This is your original &#123;% block content %&#125; -->
        <div class="max-w-7xl mx-auto py-8 sm:py-12 px-4 sm:px-6 lg:px-8">
            
            <!-- Main Content Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

                <!-- Left Column: Main Content (About & Reviews) -->
                <main class="lg:col-span-2 space-y-8">
                    
                    <!-- About Section -->
                    <div class="bg-white rounded-lg shadow-xl p-6 sm:p-8">
                        <h1 class="text-3xl font-bold text-uh-blue-700 mb-4">About {{ provider.get_full_name|default:provider.username }}</h1>
                        <div class="prose max-w-none text-gray-700">
                            <!-- 'prose' class gives nice formatting to the bio -->
                            <p>{{ provider.provider_profile.bio|linebreaksbr }}</p>
                        </div>
                    </div>

                    <!-- Reviews Section -->
                    <section class="bg-white rounded-lg shadow-xl p-6 sm:p-8">
                        <h2 class="text-2xl font-bold text-uh-blue-700 mb-6">Patient Reviews</h2>
                        {% if reviews %}
                            <div class="space-y-6">
                                {% for review in reviews %}
                                <article class="border-b border-gray-200 pb-6 last:border-b-0 last:pb-0">
                                    <div class="flex items-center justify-between mb-2">
                                        <!-- Patient Name -->
                                        <h3 class="text-lg font-semibold text-gray-900">{{ review.appointment.patient.get_full_name }}</h3>
                                        
                                        <!-- Professional Star Rating -->
                                        <div class="flex items-center" title="{{ review.rating }} out of 5 stars">
                                            {% with ''|center:review.rating as range %}
                                            {% for _ in range %}
                                            <!-- Solid Star (filled) -->
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-yellow-500">
                                              <path fill-rule="evenodd" d="M10.868 2.884c.321-.772 1.415-.772 1.736 0l1.99 4.84c.12.292.395.495.71.534l5.337.774c.82.12 1.15.918.553 1.54l-3.863 3.766c-.24.234-.348.58-.29.914l.913 5.316c.14.815-.71.144-1.446-.3l-4.768-2.507a1.04 1.04 0 00-.968 0l-4.768 2.507c-.736.444-1.586.515-1.446-.3l.913-5.316c.058-.334-.05-.68-.29-.914L.91 10.572c-.597-.622-.267-1.42.553-1.54l5.337-.774c.315-.04.59-.242.71-.534l1.99-4.84z" clip-rule="evenodd" />
                                            </svg>
                                            {% endfor %}
                                            {% endwith %}
                                            
                                            {% with ''|center:review.get_empty_stars as range %}
                                            {% for _ in range %}
                                            <!-- Outline Star (empty) -->
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-gray-300">
                                              <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.31h5.375c.621 0 .882.79.423 1.18l-4.337 3.16a.563.563 0 00-.162.524l1.62 5.034c.117.362-.27.693-.592.498l-4.66-3.05a.563.563 0 00-.58 0l-4.66 3.05c-.322.195-.71.135-.592-.498l1.62-5.034a.563.563 0 00-.162-.524l-4.337-3.16c-.46-.39-.198-1.18.423-1.18h5.375a.563.563 0 00.475-.31l2.125-5.111z" />
                                            </svg>
                                            {% endfor %}
                                            {% endwith %}
                                        </div>
                                    </div>
                                    <p class="text-gray-700">{{ review.review_text|linebreaksbr }}</p>
                                </article>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="text-gray-600">No reviews yet for this provider.</p>
                        {% endif %}
                    </section>
                </main>

                <!-- Right Column: Sidebar (Provider Card & Schedule) -->
                <aside class="lg:col-span-1 space-y-6">
                    
                    <!-- Provider Header Card -->
                    <div class="bg-white rounded-lg shadow-xl p-6 text-center">
                        <!-- Provider Avatar -->
                        <div class="w-32 h-32 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center mx-auto mb-4">
                            {% if provider.provider_profile and provider.provider_profile.avatar_url %}
                                <img src="{{ provider.provider_profile.avatar_url }}" alt="{{ provider.get_full_name }}" class="w-full h-full object-cover" />
                            {% elif provider.profile_image %}
                                <img src="{{ provider.profile_image }}" alt="{{ provider.get_full_name }}" class="w-full h-full object-cover" />
                            {% else %}
                                <span class="text-5xl font-bold text-uh-blue-600">{{ provider.first_name.0|upper }}</span>
                            {% endif %}
                        </div>
                        
                        <!-- Name & Specialization -->
                        <h2 class="text-2xl font-bold text-gray-900">{{ provider.get_full_name|default:provider.username }}</h2>
                        <p class="text-base text-uh-blue-700 font-medium mb-5">{{ provider.provider_profile.get_specialization_display }}</p>

                        <!-- Booking Button -->
                        {% url 'appointments:book_personal_appointment' provider.id as book_url %}
                        <div>
                            {% if user.is_authenticated and user.role == 'patient' %}
                                <a href="{{ book_url }}" class="w-full block text-center bg-uh-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-uh-blue-600 focus:outline-none focus:ring-2 focus:ring-uh-blue-700 focus:ring-offset-2 transition-all duration-200">
                                    Book Appointment
                                </a>
                            {% else %}
                                <a href="{% url 'accounts:login' %}?next={{ book_url }}" class="w-full block text-center font-semibold text-gray-700 bg-white border border-gray-300 py-3 px-6 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition-all duration-200">
                                    Login to Book
                                </a>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Available Schedule Card -->
                    <section class="bg-white rounded-lg shadow-xl p-6 sm:p-8">
                        <h2 class="text-2xl font-bold text-uh-blue-700 mb-6">Available Schedule</h2>
                        {% if schedules %}
                            <ul classD="space-y-3">
                                {% for s in schedules %}
                                    <li class="flex justify-between items-center text-gray-700 border-b border-gray-200 pb-3 last:border-b-0 last:pb-0">
                                        <span class="font-medium">{{ s.get_day_display }}</span>
                                        <span class="font-mono text-gray-900">{{ s.start_time|time:"g:i A" }} - {{ s.end_time|time:"g:i A" }}</span>
                                    </li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            <p class="text-gray-600">No available schedule has been posted.</p>
                        {% endif %}
                    </section>

                </aside>

            </div>
        
        </div>
        <!-- End of your original {% block content %} -->

    </div> <!-- End #page-content -->

</body>
</html>